(EXISTS usr. attempt(usr,ip1,"True") AND
  PREV ONCE[0,30000] (attempt(usr,ip2,"False") AND
  PREV ONCE[0,30000] attempt(usr,ip3,"False"))) AND (NOT ip1 = ip2) AND (NOT ip1 = ip3)
